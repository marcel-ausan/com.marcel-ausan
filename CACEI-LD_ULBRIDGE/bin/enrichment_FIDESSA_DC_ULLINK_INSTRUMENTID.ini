[rules]
rule_1 = FUTURE
rule_2 = OPTIONS - FULL DATE
rule_3 = OPTIONS
rule_4 = STRAT
rule_5 = STANDARD-NOCACHE
rule_6 = FUTURE-NOCACHE
rule_7 = OPTIONS-NOCACHE
rule_8 = STRAT-NOCACHE
rule_9 = STANDARD

[rules/rule_1/properties]
type = standard

[rules/rule_1/result]
real_found = real
fungible_found = next_rule

[rules/rule_1/search]
condition = if (startsWith($CFICODE,"F"))
ULFLOW.request.plugin = ODS
ULFLOW.request.timeout = 100
SYMBOL = underlying-instrument-code
SECURITYEXCHANGE = trading-venue, mapping_0
MATURITYMONTHYEAR = maturity-date
CFICODE = cfi-code, mapping_1

[rules/rule_2/properties]
type = standard

[rules/rule_2/result]
real_found = real
fungible_found = fungible

[rules/rule_2/search]
condition = if (startsWith($CFICODE,"O"))
ULFLOW.request.plugin = ODS
ULFLOW.request.timeout = 100
SYMBOL = underlying-instrument-code
MATURITYDATE = maturity-date-full
STRIKEPRICE = strike-price
CFICODE = cfi-code, mapping_1
CURRENCY = price-currency
SECURITYEXCHANGE = trading-venue, mapping_0

[rules/rule_3/properties]
type = standard

[rules/rule_3/result]
real_found = real
fungible_found = fungible

[rules/rule_3/search]
condition = if (startsWith($CFICODE,"O"))
ULFLOW.request.plugin = ODS
ULFLOW.request.timeout = 100
SYMBOL = underlying-instrument-code
MATURITYMONTHYEAR = maturity-date
STRIKEPRICE = strike-price
CFICODE = cfi-code, mapping_1
CURRENCY = price-currency
SECURITYEXCHANGE = trading-venue, mapping_0

[rules/rule_4/properties]
type = standard

[rules/rule_4/result]
real_found = real
fungible_found = fungible

[rules/rule_4/search]
condition = if ($MULTILEGREPORTINGTYPE="multileg")
ULFLOW.request.plugin = ODS
ULFLOW.request.timeout = 100
EXDESTINATION = trading-venue, mapping_0
SECURITYID = symbol

[rules/rule_5/properties]
type = standard

[rules/rule_5/result]
real_found = real
fungible_found = fungible

[rules/rule_5/search]
condition = if (true)
ULFLOW.request.plugin = ODSNOCACHE
ULFLOW.request.timeout = 5000
EXCHANGECODE = symbol
SECURITYEXCHANGE = trading-venue, mapping_0

[rules/rule_6/properties]
type = standard

[rules/rule_6/result]
real_found = real
fungible_found = next_rule

[rules/rule_6/search]
condition = if (startsWith($CFICODE,"F"))
ULFLOW.request.plugin = ODSNOCACHE
ULFLOW.request.timeout = 5000
SYMBOL = underlying-instrument-code
SECURITYEXCHANGE = trading-venue, mapping_0
MATURITYMONTHYEAR = maturity-date
CFICODE = cfi-code, mapping_1

[rules/rule_7/properties]
type = standard

[rules/rule_7/result]
real_found = real
fungible_found = fungible

[rules/rule_7/search]
condition = if (startsWith($CFICODE,"O"))
ULFLOW.request.plugin = ODSNOCACHE
ULFLOW.request.timeout = 5000
SYMBOL = underlying-instrument-code
MATURITYMONTHYEAR = maturity-date
STRIKEPRICE = strike-price
CFICODE = cfi-code, mapping_1
CURRENCY = price-currency
SECURITYEXCHANGE = trading-venue, mapping_0

[rules/rule_8/properties]
type = standard

[rules/rule_8/result]
real_found = real
fungible_found = fungible

[rules/rule_8/search]
condition = if ($MULTILEGREPORTINGTYPE="multileg")
ULFLOW.request.plugin = ODSNOCACHE
ULFLOW.request.timeout = 5000
EXDESTINATION = trading-venue, mapping_0
SECURITYID = symbol

[rules/rule_9/properties]
type = standard

[rules/rule_9/result]
real_found = real
fungible_found = fungible

[rules/rule_9/search]
condition = if (true)
ULFLOW.request.plugin = ODS
ULFLOW.request.timeout = 100
EXCHANGECODE = symbol
SECURITYEXCHANGE = trading-venue, mapping_0

[mappings]
mapping_0 = EXDESTINATION mapping
mapping_1 = CFICODE

[mapping/mapping_0]
XCBO = OPRA|
IFLO = IFEU|
XSFE = XSFE|NZFX|
XHKG = XHKG|XHKF|
IFLX = IFEU|
XMON = XMON|XMAT|
IFLL = IFEU|
SEED = XSTO|
NOED = XSTO|
DKED = XSTO|

[mapping/mapping_1]
F* = FXXXXX|
OC* = OCXXXX|
OP* = OPXXXX|
FCAXSX = FXXXXX|

[convert-currencies]
GBP = True
ILS = False
ZAR = False
USD = True
AUD = True

[enrich-tags]
INSTRUMENTID = odisys-instrument-id

[enrich-tags/legs]
MATUTIRITYMONTHYEAR = maturity-date
LEGREFID = leg-index
UNDERLYING = underlying-instrument-code
