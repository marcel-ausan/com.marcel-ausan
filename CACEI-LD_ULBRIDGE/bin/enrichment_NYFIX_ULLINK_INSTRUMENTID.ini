[rules]
rule_0 = EQUITY - ISINCODE & CURRENCY & EXDESTINATION
rule_1 = FUTURE - EXCHANGECODE & MATURITY & EXDESTINATION
rule_2 = OPTION - EXCHANGECODE & MATURITY & STRIKEPRICE & EXDESTINATION

[rules/rule_0/properties]
type = standard

[rules/rule_0/result]
real_found = real
fungible_found = preferred_real

[rules/rule_0/search]
condition = if (not empty($ISINCODE))
ULFLOW.request.plugin = ODS
ULFLOW.request.timeout = 100
ISINCODE = isin-code
CURRENCY = price-currency
EXDESTINATION = trading-venue

[rules/rule_1/properties]
type = standard

[rules/rule_1/result]
real_found = real
fungible_found = next_rule

[rules/rule_1/search]
condition = if true
ULFLOW.request.plugin = ODS
ULFLOW.request.timeout = 1000
SYMBOL = gl-instrument-code
MATURITYDATE = maturity-date-full
EXDESTINATION = trading-venue, mapping_0
CURRENCY = price-currency
CFICODE = cfi-code

[rules/rule_2/properties]
type = standard

[rules/rule_2/result]
real_found = real
fungible_found = next_rule

[rules/rule_2/search]
condition = if true
ULFLOW.request.plugin = ODS
ULFLOW.request.timeout = 1000
SYMBOL = gl-instrument-code
MATURITYDATE = maturity-date-full
PUTORCALL = put-or-call
STRIKEPRICE = strike-price
EXDESTINATION = trading-venue, mapping_0
CURRENCY = price-currency

[mappings]
mapping_0 = ExchangeMapping

[mapping/mapping_0]
PA = XMON|XMAT|
EX = XEUR|
J = XJSE|
TA = XTAE|

[convert-currencies]
GBP = True
ILS = True
ZAR = True
USD = True
AUD = True

[enrich-tags]
EXDESTINATION = trading-venue
ULLINK.CFICODE = cfi-code
